(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{5644:function(e,r,t){Promise.resolve().then(t.bind(t,9826))},9826:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var a=t(7437),s=t(9376),n=t(3388);function o(){let e=(0,s.useRouter)();return(0,a.jsxs)("div",{className:"max-w-2xl",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold mb-4",children:"Publicar producto"}),(0,a.jsx)(n.default,{onSaved:()=>e.replace("/vendedor/productos")})]})}},6941:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(7437);function s(e){let{children:r,className:t="",loading:s=!1,...n}=e;return(0,a.jsxs)("button",{className:"btn-primary inline-flex items-center justify-center min-h-[44px] ".concat(t),disabled:s||n.disabled,...n,children:[s&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),r]})}},9382:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(7437);function s(e){let{label:r,error:t,className:s="",...n}=e;return(0,a.jsxs)("label",{className:"block w-full",children:[r&&(0,a.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:r}),(0,a.jsx)("input",{className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary ".concat(s),...n}),t&&(0,a.jsx)("span",{className:"text-sm text-danger mt-1 block",children:t})]})}},3388:function(e,r,t){"use strict";t.d(r,{default:function(){return i}});var a=t(7437),s=t(2265),n=t(9382),o=t(6941);function i(e){let{initial:r={},onSaved:t}=e,[i,c]=(0,s.useState)({titulo:"",descripcion:"",precio:0,categoria:"utiles",stock:0,disponible:!0,imagenes:[],...r}),[l,u]=(0,s.useState)(!1),[d,m]=(0,s.useState)("");async function p(e){let r=new FormData;r.append("file",e);try{let e=await fetch("/api/upload",{method:"POST",body:r}),t=e.headers.get("content-type");if(!t||!t.includes("application/json")){let r=await e.text();throw console.error("Server returned non-JSON response:",r.substring(0,200)),Error("Error del servidor al procesar la imagen")}let a=await e.json();if(!e.ok)throw Error(a.error||"Error al subir imagen");return a.url}catch(e){throw console.error("Upload error:",e),Error(e.message||"Error al subir imagen. Verifica tu conexi\xf3n.")}}async function x(e){e.preventDefault(),u(!0),m("");try{let e={...i,precio:Number(i.precio),stock:Number(i.stock)},a=r._id?"/api/productos/".concat(r._id):"/api/productos",s=r._id?"PUT":"POST",n=await fetch(a,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await n.json();if(!n.ok)throw Error(o.error||"Error");null==t||t(o)}catch(e){m(e.message)}finally{u(!1)}}return(0,a.jsxs)("form",{onSubmit:x,className:"space-y-3",children:[(0,a.jsx)(n.Z,{label:"T\xedtulo*",value:i.titulo,onChange:e=>c({...i,titulo:e.target.value})}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n*"}),(0,a.jsx)("textarea",{className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary",rows:4,value:i.descripcion,onChange:e=>c({...i,descripcion:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(n.Z,{label:"Precio*",type:"number",min:"0",step:"0.1",value:i.precio,onChange:e=>c({...i,precio:e.target.value})}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda*"}),(0,a.jsxs)("select",{className:"w-full rounded-lg border border-gray-300 px-3 py-2",value:i.categoria,onChange:e=>c({...i,categoria:e.target.value}),children:[(0,a.jsx)("option",{value:"utiles",children:"\xdatiles"}),(0,a.jsx)("option",{value:"comida",children:"Comida"}),(0,a.jsx)("option",{value:"tecnologia",children:"Tecnolog\xeda"}),(0,a.jsx)("option",{value:"ropa",children:"Ropa"}),(0,a.jsx)("option",{value:"otros",children:"Otros"})]})]}),(0,a.jsx)(n.Z,{label:"Stock*",type:"number",min:"0",value:i.stock,onChange:e=>c({...i,stock:e.target.value})}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:i.disponible,onChange:e=>c({...i,disponible:e.target.checked})}),"Disponible"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Im\xe1genes (1-3)"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t)try{let e=await p(t);c(r=>({...r,imagenes:[...r.imagenes||[],e].slice(0,3)}))}catch(e){m(e.message)}}}),(0,a.jsx)("div",{className:"flex gap-2 mt-2",children:(i.imagenes||[]).map((e,r)=>(0,a.jsx)("img",{src:e,alt:"img",className:"w-16 h-16 object-cover rounded"},r))})]}),d&&(0,a.jsx)("p",{className:"text-danger text-sm",children:d}),(0,a.jsx)(o.Z,{loading:l,type:"submit",children:"Guardar"})]})}},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5644)}),_N_E=e.O()}]);