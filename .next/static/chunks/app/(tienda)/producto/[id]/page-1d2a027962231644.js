(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[401],{7514:function(e,t,r){Promise.resolve().then(r.bind(r,2047))},2047:function(e,t,r){"use strict";r.d(t,{AddToCart:function(){return o}});var a=r(7437),n=r(2265),i=r(6941),c=r(471);function o(e){let{product:t}=e,[r,o]=(0,n.useState)(1),{addItem:d,setOpen:s}=(0,c.A)(),l=Math.max(0,t.stock||0);return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>o(Math.max(1,r-1)),children:"-"}),(0,a.jsx)("span",{children:r}),(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>o(Math.min(l,r+1)),children:"+"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 ml-2",children:["Stock: ",l]})]}),(0,a.jsx)(i.Z,{disabled:0===l,onClick:()=>{var e;d({producto_id:t._id,titulo:t.titulo,precio:t.precio,cantidad:r,imagen:null===(e=t.imagenes)||void 0===e?void 0:e[0],stock:t.stock,vendedor_id:t.vendedor_id}),s(!0)},children:"Agregar al carrito"})]})}},6941:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(7437);function n(e){let{children:t,className:r="",loading:n=!1,...i}=e;return(0,a.jsxs)("button",{className:"btn-primary inline-flex items-center justify-center min-h-[44px] ".concat(r),disabled:n||i.disabled,...i,children:[n&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),t]})}},471:function(e,t,r){"use strict";r.d(t,{A:function(){return d},CarritoProvider:function(){return o}});var a=r(7437),n=r(2265);let i=(0,n.createContext)();function c(e,t){switch(t.type){case"INIT":return t.payload||[];case"ADD":if(e.find(e=>e.producto_id===t.payload.producto_id))return e.map(e=>{var r;return e.producto_id===t.payload.producto_id?{...e,cantidad:Math.min(null!==(r=e.stock)&&void 0!==r?r:99,e.cantidad+t.payload.cantidad)}:e});return[...e,t.payload];case"UPDATE_QTY":return e.map(e=>e.producto_id===t.id?{...e,cantidad:t.cantidad}:e);case"REMOVE":return e.filter(e=>e.producto_id!==t.id);case"CLEAR":return[];default:return e}}function o(e){let{children:t}=e,[r,o]=(0,n.useReducer)(c,[]),[d,s]=(0,n.useState)(!1);(0,n.useEffect)(()=>{try{let e=localStorage.getItem("carrito");e&&o({type:"INIT",payload:JSON.parse(e)})}catch(e){}},[]),(0,n.useEffect)(()=>{try{localStorage.setItem("carrito",JSON.stringify(r))}catch(e){}},[r]);let l=(0,n.useMemo)(()=>({items:r,open:d,setOpen:s,addItem:e=>o({type:"ADD",payload:e}),updateCantidad:(e,t)=>o({type:"UPDATE_QTY",id:e,cantidad:t}),removeItem:e=>o({type:"REMOVE",id:e}),clear:()=>o({type:"CLEAR"})}),[r,d]);return(0,a.jsx)(i.Provider,{value:l,children:t})}function d(){let e=(0,n.useContext)(i);if(!e)throw Error("useCarrito debe usarse dentro de CarritoProvider");return e}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7514)}),_N_E=e.O()}]);