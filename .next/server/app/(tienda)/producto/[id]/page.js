(()=>{var e={};e.id=401,e.ids=[401],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},82950:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>l,pages:()=>u,routeModule:()=>m,tree:()=>c}),r(34016),r(76803),r(35866),r(60940);var n=r(23191),o=r(88716),i=r(37922),a=r.n(i),d=r(95231),s={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>d[e]);r.d(t,s);let c=["",{children:["(tienda)",{children:["producto",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,34016)),"C:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\(tienda)\\producto\\[id]\\page.js"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,76803)),"C:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\(tienda)\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,60940)),"C:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\(tienda)\\producto\\[id]\\page.js"],l="/(tienda)/producto/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/(tienda)/producto/[id]/page",pathname:"/producto/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3221:(e,t,r)=>{Promise.resolve().then(r.bind(r,57325))},35303:()=>{},57325:(e,t,r)=>{"use strict";r.d(t,{AddToCart:()=>d});var n=r(10326),o=r(17577),i=r(87434),a=r(88313);function d({product:e}){let[t,r]=(0,o.useState)(1),{addItem:d,setOpen:s}=(0,a.A)(),c=Math.max(0,e.stock||0);return(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>r(Math.max(1,t-1)),children:"-"}),n.jsx("span",{children:t}),n.jsx("button",{className:"px-3 py-1 border rounded",onClick:()=>r(Math.min(c,t+1)),children:"+"}),(0,n.jsxs)("span",{className:"text-sm text-gray-600 ml-2",children:["Stock: ",c]})]}),n.jsx(i.Z,{disabled:0===c,onClick:()=>{d({producto_id:e._id,titulo:e.titulo,precio:e.precio,cantidad:t,imagen:e.imagenes?.[0],stock:e.stock,vendedor_id:e.vendedor_id}),s(!0)},children:"Agregar al carrito"})]})}},76803:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(19510);function o({children:e}){return n.jsx("div",{children:e})}},34016:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,dynamic:()=>d,runtime:()=>s});var n=r(19510),o=r(61085),i=r(59094);let a=(0,r(68570).createProxy)(String.raw`C:\Users\dpovi\Unimarket\marketplace-facultad\app\(tienda)\producto\[id]\ui.js#AddToCart`),d="force-dynamic",s="nodejs";async function c({params:e}){try{let t=await (0,i.F)(),r=await t.findById(e.id).lean();if(!r)return(0,o.notFound)();let d=JSON.parse(JSON.stringify(r));return(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[n.jsx("img",{src:d.imagenes?.[0]||"/placeholder.png",alt:d.titulo,className:"w-full rounded-xl object-cover aspect-square"}),d.imagenes?.length>1&&n.jsx("div",{className:"flex gap-2 mt-2",children:d.imagenes.map((e,t)=>n.jsx("img",{src:e,alt:"mini",className:"w-16 h-16 object-cover rounded"},t))})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[n.jsx("h1",{className:"text-2xl font-semibold",children:d.titulo}),n.jsx("p",{className:"text-gray-700",children:d.descripcion}),(0,n.jsxs)("p",{className:"text-2xl text-primary font-bold",children:["S/ ",d.precio.toFixed(2)]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Vendedor: ",d.vendedor_nombre||"Estudiante"]}),n.jsx(a,{product:d})]})]})}catch(e){return console.error("Error loading product:",e),(0,o.notFound)()}}},59094:(e,t,r)=>{"use strict";r.d(t,{F:()=>d});var n=r(11185),o=r.n(n),i=r(39584);let a=new n.Schema({titulo:{type:String,required:!0,maxlength:100},descripcion:{type:String,required:!0,maxlength:500},precio:{type:Number,required:!0,min:0},categoria:{type:String,required:!0,enum:["utiles","comida","tecnologia","ropa","otros"]},imagenes:{type:[String],default:[],validate:[e=>e.length<=3,"M\xe1ximo 3 im\xe1genes"]},stock:{type:Number,required:!0,default:0,min:0},disponible:{type:Boolean,default:!0},vendedor_id:{type:String},vendedor_nombre:{type:String}},{timestamps:{createdAt:"fecha_creacion",updatedAt:"fecha_actualizacion"}});async function d(){return await (0,i.u)(),o().models.Product||o().model("Product",a,"productos")}},39584:(e,t,r)=>{"use strict";r.d(t,{u:()=>s});let n=require("mongodb");var o=r(11185),i=r.n(o);let a=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Add Mongo URI to .env.local");new n.MongoClient(a,{}).connect();let d=global._mongooseConn||null;async function s(){return d&&1===i().connection.readyState||(i().set("strictQuery",!0),d=await i().connect(a,{dbName:"marketplace"}),global._mongooseConn=d),d}},61085:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return a},RedirectType:function(){return n.RedirectType},notFound:function(){return o.notFound},permanentRedirect:function(){return n.permanentRedirect},redirect:function(){return n.redirect}});let n=r(83953),o=r(16399);class i extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class a extends URLSearchParams{append(){throw new i}delete(){throw new i}set(){throw new i}sort(){throw new i}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8586:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83953:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return n},getRedirectError:function(){return s},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return p},isRedirectError:function(){return l},permanentRedirect:function(){return u},redirect:function(){return c}});let o=r(54580),i=r(72934),a=r(8586),d="NEXT_REDIRECT";function s(e,t,r){void 0===r&&(r=a.RedirectStatusCode.TemporaryRedirect);let n=Error(d);n.digest=d+";"+t+";"+e+";"+r+";";let i=o.requestAsyncStorage.getStore();return i&&(n.mutableCookies=i.mutableCookies),n}function c(e,t){void 0===t&&(t="replace");let r=i.actionAsyncStorage.getStore();throw s(e,t,(null==r?void 0:r.isAction)?a.RedirectStatusCode.SeeOther:a.RedirectStatusCode.TemporaryRedirect)}function u(e,t){void 0===t&&(t="replace");let r=i.actionAsyncStorage.getStore();throw s(e,t,(null==r?void 0:r.isAction)?a.RedirectStatusCode.SeeOther:a.RedirectStatusCode.PermanentRedirect)}function l(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r,n,o]=e.digest.split(";",4),i=Number(o);return t===d&&("replace"===r||"push"===r)&&"string"==typeof n&&!isNaN(i)&&i in a.RedirectStatusCode}function p(e){return l(e)?e.digest.split(";",3)[2]:null}function m(e){if(!l(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function f(e){if(!l(e))throw Error("Not a redirect error");return Number(e.digest.split(";",4)[3])}(function(e){e.push="push",e.replace="replace"})(n||(n={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,200,231],()=>r(82950));module.exports=n})();