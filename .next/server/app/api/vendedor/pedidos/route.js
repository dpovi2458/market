"use strict";(()=>{var e={};e.id=925,e.ids=[925],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},32261:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v});var n={};r.r(n),r.d(n,{GET:()=>c,PATCH:()=>l,runtime:()=>p});var o=r(49303),i=r(88716),a=r(60670),s=r(87070),d=r(52297),u=r(77999);let p="nodejs";async function c(){let e=(0,u.Cr)();if(!e)return s.NextResponse.json({error:"No autorizado"},{status:401});let t=await (0,d.D)(),r=await t.find({vendedor_id:e.id}).sort({fecha_pedido:-1}).lean();return s.NextResponse.json({items:r})}async function l(e){let t=(0,u.Cr)();if(!t)return s.NextResponse.json({error:"No autorizado"},{status:401});let{id:r,estado:n}=await e.json(),o=await (0,d.D)();return await o.updateOne({_id:r,vendedor_id:t.id},{$set:{estado:n}}),s.NextResponse.json({ok:!0})}let m=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/vendedor/pedidos/route",pathname:"/api/vendedor/pedidos",filename:"route",bundlePath:"app/api/vendedor/pedidos/route"},resolvedPagePath:"C:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\api\\vendedor\\pedidos\\route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:x}=m,f="/api/vendedor/pedidos/route";function y(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},77999:(e,t,r)=>{r.d(t,{Cr:()=>s,fT:()=>a});var n=r(41482),o=r.n(n),i=r(71615);function a(e,t={}){let r=process.env.JWT_SECRET;if(!r)throw Error("Falta JWT_SECRET");return o().sign(e,r,{expiresIn:"7d",...t})}function s(){try{let e=i.cookies().get("vendedor_token")?.value;if(!e)return null;let t=process.env.JWT_SECRET;return o().verify(e,t)}catch{return null}}},52297:(e,t,r)=>{r.d(t,{D:()=>d});var n=r(11185),o=r.n(n),i=r(39584);let a=new n.Schema({producto_id:{type:n.Schema.Types.ObjectId,ref:"Product",required:!0},titulo:String,precio:Number,cantidad:Number,subtotal:Number}),s=new n.Schema({productos:[a],total:Number,comprador:{nombre:{type:String,required:!0},telefono:{type:String,required:!0},email:String,punto_entrega:{type:String,required:!0},comentarios:String},vendedor_id:{type:String},estado:{type:String,enum:["pendiente","entregado"],default:"pendiente"}},{timestamps:{createdAt:"fecha_pedido",updatedAt:!1}});async function d(){return await (0,i.u)(),o().models.Order||o().model("Order",s,"pedidos")}},39584:(e,t,r)=>{r.d(t,{u:()=>d});let n=require("mongodb");var o=r(11185),i=r.n(o);let a=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Add Mongo URI to .env.local");new n.MongoClient(a,{}).connect();let s=global._mongooseConn||null;async function d(){return s&&1===i().connection.readyState||(i().set("strictQuery",!0),s=await i().connect(a,{dbName:"marketplace"}),global._mongooseConn=s),s}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,261],()=>r(32261));module.exports=n})();