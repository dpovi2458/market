"use strict";(()=>{var e={};e.id=484,e.ids=[484],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},93907:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>h,patchFetch:()=>w,requestAsyncStorage:()=>y,routeModule:()=>x,serverHooks:()=>v,staticGenerationAsyncStorage:()=>f});var n={};o.r(n),o.d(n,{DELETE:()=>g,GET:()=>c,PUT:()=>m,runtime:()=>p});var r=o(49303),a=o(88716),i=o(60670),s=o(87070),d=o(59094),u=o(21067);let p="nodejs";async function c(e,{params:t}){let o=await (0,d.F)(),n=await o.findById(t.id).lean();return n?s.NextResponse.json(n):s.NextResponse.json({error:"No encontrado"},{status:404})}let l=u.Ry({titulo:u.Z_().min(1).max(100).optional(),descripcion:u.Z_().min(1).max(500).optional(),precio:u.Rx().nonnegative().optional(),categoria:u.Km(["utiles","comida","tecnologia","ropa","otros"]).optional(),imagenes:u.IX(u.Z_().url()).max(3).optional(),stock:u.Rx().int().min(0).optional(),disponible:u.O7().optional()});async function m(e,{params:t}){try{let o=await e.json(),n=l.parse(o),r=await (0,d.F)(),a=await r.findByIdAndUpdate(t.id,n,{new:!0});if(!a)return s.NextResponse.json({error:"No encontrado"},{status:404});return s.NextResponse.json(a)}catch(t){let e=t?.errors?.[0]?.message||t.message||"Error";return s.NextResponse.json({error:e},{status:400})}}async function g(e,{params:t}){let o=await (0,d.F)();return await o.findByIdAndDelete(t.id),s.NextResponse.json({ok:!0})}let x=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/productos/[id]/route",pathname:"/api/productos/[id]",filename:"route",bundlePath:"app/api/productos/[id]/route"},resolvedPagePath:"c:\\Users\\dpovi\\Unimarket\\marketplace-facultad\\app\\api\\productos\\[id]\\route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:v}=x,h="/api/productos/[id]/route";function w(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:f})}},59094:(e,t,o)=>{o.d(t,{F:()=>s});var n=o(11185),r=o.n(n),a=o(39584);let i=new n.Schema({titulo:{type:String,required:!0,maxlength:100},descripcion:{type:String,required:!0,maxlength:500},precio:{type:Number,required:!0,min:0},categoria:{type:String,required:!0,enum:["utiles","comida","tecnologia","ropa","otros"]},imagenes:{type:[String],default:[],validate:[e=>e.length<=3,"M\xe1ximo 3 im\xe1genes"]},stock:{type:Number,required:!0,default:0,min:0},disponible:{type:Boolean,default:!0},vendedor_id:{type:String},vendedor_nombre:{type:String}},{timestamps:{createdAt:"fecha_creacion",updatedAt:"fecha_actualizacion"}});async function s(){return await (0,a.u)(),r().models.Product||r().model("Product",i,"productos")}},39584:(e,t,o)=>{o.d(t,{u:()=>d});let n=require("mongodb");var r=o(11185),a=o.n(r);let i=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Add Mongo URI to .env.local");new n.MongoClient(i,{}).connect();let s=global._mongooseConn||null;async function d(){return s&&1===a().connection.readyState||(a().set("strictQuery",!0),s=await a().connect(i,{dbName:"marketplace"}),global._mongooseConn=s),s}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),n=t.X(0,[276,972,67],()=>o(93907));module.exports=n})();