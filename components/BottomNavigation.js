"use client";
import Link from 'next/link';
import { usePathname } from 'next/navigation';

// Iconos SVG Profesionales
const HomeIcon = () => (
  <svg width="24" height="24" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g clipPath="url(#clip0)">
      <path fillRule="evenodd" clipRule="evenodd" d="M8.96815 0.951215L12.8006 3.56308C13.2271 3.85375 13.576 4.24428 13.8169 4.70066C14.0579 5.15704 14.1836 5.66543 14.1831 6.1815V11.7749C14.1831 12.4711 13.9066 13.1388 13.4143 13.6311C12.922 14.1233 12.2543 14.3999 11.5581 14.3999H2.80818C2.11198 14.3999 1.4443 14.1233 0.952021 13.6311C0.459742 13.1388 0.183181 12.4711 0.183181 11.7749V6.18807C0.181628 5.67088 0.306832 5.16117 0.547841 4.70357C0.788847 4.24597 1.13832 3.85439 1.56567 3.56308L5.39816 0.951215C5.92415 0.592044 6.54622 0.399902 7.18316 0.399902C7.82007 0.399902 8.44217 0.592044 8.96815 0.951215ZM12.1768 12.3936C12.3409 12.2295 12.4331 12.007 12.4331 11.7749V6.1815C12.4331 5.95044 12.3768 5.72287 12.2689 5.51854C12.161 5.31423 12.0049 5.13932 11.8141 5.00901L7.98159 2.39715C7.74646 2.23613 7.46812 2.14996 7.18316 2.14996C6.89817 2.14996 6.61986 2.23613 6.38472 2.39715L2.55224 5.00901C2.36142 5.13932 2.2053 5.31423 2.09742 5.51854C1.98953 5.72287 1.93316 5.95044 1.93317 6.1815V11.7749C1.93317 12.007 2.02536 12.2295 2.18945 12.3936C2.35355 12.5577 2.57611 12.6499 2.80818 12.6499H11.5581C11.7902 12.6499 12.0128 12.5577 12.1768 12.3936ZM4.99567 9.14991H9.37065C9.60269 9.14991 9.82525 9.24211 9.98936 9.40619C10.1534 9.5703 10.2456 9.79285 10.2456 10.0249C10.2456 10.257 10.1534 10.4795 9.98936 10.6436C9.82525 10.8077 9.60269 10.8999 9.37065 10.8999H4.99567C4.7636 10.8999 4.54104 10.8077 4.37693 10.6436C4.21285 10.4795 4.12067 10.257 4.12067 10.0249C4.12067 9.79285 4.21285 9.5703 4.37693 9.40619C4.54104 9.24211 4.7636 9.14991 4.99567 9.14991Z" fill="currentColor"/>
      <defs>
        <clipPath id="clip0">
          <rect width="14" height="14" fill="white" transform="translate(0.183167 0.399902)"/>
        </clipPath>
      </defs>
    </g>
  </svg>
);

const ProductsIcon = () => (
  <svg width="24" height="24" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g clipPath="url(#clip0)">
      <path d="M1.05817 14.3999H13.3082C13.5402 14.3999 13.7628 14.3077 13.9269 14.1436C14.091 13.9795 14.1832 13.757 14.1832 13.5249C14.1832 13.2928 14.091 13.0703 13.9269 12.9062C13.7628 12.7421 13.5402 12.6499 13.3082 12.6499H12.6519V8.25084C13.0569 7.98143 13.3887 7.61582 13.6178 7.18674C13.8468 6.75765 13.9659 6.27848 13.9644 5.79209C13.9673 5.31454 13.8935 4.83963 13.7457 4.38553L12.956 2.04271C12.7964 1.56568 12.4913 1.15065 12.0836 0.855983C11.676 0.56131 11.1862 0.401809 10.6832 0.399902H3.68317C3.17903 0.400438 2.68779 0.559304 2.2788 0.854072C1.86981 1.14884 1.56374 1.56462 1.40379 2.04271L0.620667 4.38553C0.472848 4.83963 0.398989 5.31454 0.401917 5.79209C0.400407 6.27848 0.519505 6.75765 0.748554 7.18674C0.977602 7.61582 1.30946 7.98143 1.71442 8.25084V12.6499H1.05817C0.826102 12.6499 0.603543 12.7421 0.439448 12.9062C0.275354 13.0703 0.183167 13.2928 0.183167 13.5249C0.183167 13.757 0.275354 13.9795 0.439448 14.1436C0.603543 14.3077 0.826102 14.3999 1.05817 14.3999ZM10.9019 12.6499H3.46442V8.7124C4.11223 8.66613 4.72386 8.39627 5.19473 7.94896L5.21442 7.93147C5.74394 8.43949 6.44935 8.72316 7.18317 8.72316C7.91698 8.72316 8.62239 8.43949 9.15192 7.93147L9.1716 7.94896C9.64248 8.39627 10.2541 8.66613 10.9019 8.7124V12.6499ZM2.28973 4.93896L3.07067 2.5874C3.11554 2.46045 3.19839 2.35037 3.30796 2.27211C3.41753 2.19385 3.54852 2.15118 3.68317 2.1499H10.6832C10.8189 2.14983 10.9514 2.19187 11.0623 2.27023C11.1731 2.34858 11.257 2.4594 11.3022 2.5874L12.0832 4.93021C12.1748 5.20531 12.2213 5.4934 12.221 5.78334C12.2297 6.07362 12.1284 6.35647 11.9373 6.57515C11.7462 6.79383 11.4795 6.93217 11.1907 6.9624C11.0413 6.97198 10.8915 6.95079 10.7506 6.90013C10.6097 6.84947 10.4807 6.77043 10.3716 6.66789C10.2625 6.56536 10.1756 6.44151 10.1163 6.30404C10.057 6.16656 10.0266 6.01837 10.0269 5.86865C10.0269 5.63659 9.93473 5.41403 9.77063 5.24993C9.60654 5.08584 9.38398 4.99365 9.15192 4.99365C8.91985 4.99365 8.69729 5.08584 8.5332 5.24993C8.3691 5.41403 8.27692 5.63659 8.27692 5.86865C8.27692 6.15873 8.16168 6.43693 7.95656 6.64205C7.75145 6.84717 7.47325 6.9624 7.18317 6.9624C6.89309 6.9624 6.61489 6.84717 6.40977 6.64205C6.20465 6.43693 6.08942 6.15873 6.08942 5.86865C6.08942 5.63659 5.99723 5.41403 5.83313 5.24993C5.66904 5.08584 5.44648 4.99365 5.21442 4.99365C4.98235 4.99365 4.75979 5.08584 4.5957 5.24993C4.4316 5.41403 4.33942 5.63659 4.33942 5.86865C4.33972 6.01837 4.30929 6.16656 4.25 6.30404C4.19071 6.44151 4.10382 6.56536 3.99473 6.66789C3.88563 6.77043 3.75664 6.84947 3.61575 6.90013C3.47487 6.95079 3.32508 6.97198 3.17567 6.9624C2.88956 6.93074 2.62572 6.79299 2.4362 6.57634C2.24668 6.35968 2.14524 6.07986 2.15192 5.79209C2.15159 5.50215 2.19812 5.21406 2.28973 4.93896Z" fill="currentColor"/>
      <defs>
        <clipPath id="clip0">
          <rect width="14" height="14" fill="white" transform="translate(0.183167 0.399902)"/>
        </clipPath>
      </defs>
    </g>
  </svg>
);

const CartIcon = () => (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" fill="currentColor"/>
    <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" fill="currentColor"/>
    <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38787 15.5583C8.75382 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3261 15.8526 20.6921 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
  </svg>
);

const SellIcon = () => (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12.5 7H11V13L16.25 16.15L17 14.92L12.5 12.35V7Z" fill="currentColor"/>
  </svg>
);

const ProfileIcon = () => (
  <svg width="24" height="24" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fillRule="evenodd" clipRule="evenodd" d="M10.1696 7.72298C9.51214 8.1623 8.73909 8.39682 7.94829 8.39682C6.88788 8.39682 5.87088 7.97555 5.12104 7.22574C4.37123 6.47592 3.94995 5.45889 3.94995 4.39849C3.94995 3.60766 4.18445 2.83468 4.6238 2.17712C5.06314 1.51961 5.6876 1.00713 6.4182 0.704523C7.1488 0.401853 7.95274 0.322723 8.72834 0.476956C9.50394 0.631249 10.2164 1.01207 10.7756 1.57123C11.3347 2.13038 11.7155 2.84285 11.8698 3.61848C12.0241 4.39404 11.9449 5.19795 11.6423 5.9286C11.3397 6.6592 10.8272 7.28364 10.1696 7.72298ZM9.05898 2.73621C8.73022 2.51657 8.3437 2.39931 7.94829 2.39931C7.41809 2.39931 6.9096 2.60992 6.53468 2.9849C6.15976 3.35979 5.94912 3.86826 5.94912 4.39849C5.94912 4.7939 6.06637 5.18039 6.28606 5.50917C6.50571 5.83794 6.81796 6.09418 7.18326 6.24549C7.54856 6.39681 7.95051 6.43639 8.33833 6.35922C8.72612 6.2821 9.08234 6.09168 9.36193 5.81207C9.64151 5.53254 9.83191 5.17629 9.90905 4.78852C9.98619 4.40068 9.94661 3.99875 9.7953 3.63343C9.64399 3.26816 9.38774 2.95591 9.05898 2.73621ZM1.73323 16.361C1.60595 16.3977 1.47264 16.4087 1.34106 16.3935C1.25911 16.385 1.17873 16.3664 1.10169 16.3384C1.0548 16.3213 1.00915 16.3007 0.965132 16.2767C0.848818 16.2132 0.74629 16.1272 0.6635 16.0237C0.580709 15.9202 0.519333 15.8013 0.482926 15.6739C0.446518 15.5464 0.435811 15.4131 0.451414 15.2815C0.615286 13.7991 1.32097 12.4294 2.43298 11.4354C3.54499 10.4415 4.98495 9.89333 6.47643 9.8962H9.4202C10.9117 9.89333 12.3516 10.4415 13.4636 11.4354C14.5756 12.4294 15.2813 13.7991 15.4452 15.2815C15.4608 15.4131 15.4501 15.5464 15.4137 15.6739C15.3773 15.8013 15.3159 15.9202 15.2331 16.0237C15.1503 16.1272 15.0478 16.2132 14.9315 16.2767C14.8152 16.3401 14.6874 16.3798 14.5556 16.3935C14.519 16.396 14.4822 16.396 14.4456 16.3935C14.1981 16.395 13.9589 16.3045 13.7742 16.1397C13.5896 15.9749 13.4726 15.7475 13.446 15.5013C13.3355 14.5106 12.8638 13.5952 12.1213 12.9301C11.3787 12.265 10.4171 11.8966 9.4202 11.8954H6.47643C5.47949 11.8966 4.51794 12.265 3.77535 12.9301C3.03276 13.5952 2.56115 14.5106 2.45058 15.5013C2.43724 15.6332 2.39781 15.761 2.3346 15.8774C2.27141 15.9939 2.18569 16.0966 2.08247 16.1796C1.97922 16.2626 1.86051 16.3243 1.73323 16.361Z" fill="currentColor"/>
  </svg>
);

export default function BottomNavigation() {
  const pathname = usePathname();
  
  // No mostrar en rutas de vendedor
  if (pathname?.startsWith('/vendedor')) {
    return null;
  }

  const isActive = (path) => pathname === path;

  const navItems = [
    { 
      label: 'Inicio', 
      href: '/', 
      icon: HomeIcon,
      active: pathname === '/'
    },
    { 
      label: 'Productos', 
      href: '/?categoria=todos', 
      icon: ProductsIcon,
      active: pathname === '/' && new URLSearchParams(typeof window !== 'undefined' ? window.location.search : '').get('categoria')
    },
    { 
      label: 'Carrito', 
      href: '/carrito', 
      icon: CartIcon,
      active: pathname === '/carrito'
    },
    { 
      label: 'Vender', 
      href: '/vendedor/login', 
      icon: SellIcon,
      active: pathname === '/vendedor/login'
    },
    { 
      label: 'Perfil', 
      href: '#', 
      icon: ProfileIcon,
      active: false
    }
  ];

  return (
    <nav className="bottom-navigation">
      <div className="bottom-nav-container">
        {navItems.map((item) => {
          const IconComponent = item.icon;
          return (
            <Link
              key={item.label}
              href={item.href}
              className={`bottom-nav-item ${item.active ? 'active' : ''}`}
              title={item.label}
            >
              <div className="bottom-nav-icon-wrapper">
                <IconComponent />
              </div>
              <span className="bottom-nav-label">{item.label}</span>
            </Link>
          );
        })}
      </div>

      <style jsx>{`
        .bottom-navigation {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          background-color: white;
          border-top: 1px solid #e5e7eb;
          box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
          z-index: 40;
          height: 70px;
        }

        .bottom-nav-container {
          display: flex;
          justify-content: space-around;
          align-items: stretch;
          height: 100%;
          max-width: 100%;
          margin: 0 auto;
          padding: 0;
        }

        .bottom-nav-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 4px;
          padding: 8px 12px;
          flex: 1;
          text-decoration: none;
          color: #6b7280;
          transition: all 200ms ease-in-out;
          font-size: 0.7125rem;
          font-weight: 500;
          position: relative;
          cursor: pointer;
        }

        .bottom-nav-item:hover {
          color: #14b8a6;
          background-color: rgba(20, 184, 166, 0.05);
        }

        .bottom-nav-item.active {
          color: #14b8a6;
          background-color: rgba(20, 184, 166, 0.08);
        }

        .bottom-nav-item.active::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background-color: #14b8a6;
          border-radius: 0 0 3px 3px;
        }

        .bottom-nav-icon-wrapper {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 24px;
          height: 24px;
          color: currentColor;
        }

        .bottom-nav-icon-wrapper svg {
          width: 100%;
          height: 100%;
          stroke-width: 1.5;
        }

        .bottom-nav-label {
          font-size: 0.7rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.3px;
          line-height: 1;
        }

        /* Spacer para el contenido cuando hay nav bottom */
        @media (max-width: 1024px) {
          .bottom-navigation {
            height: 65px;
          }

          .bottom-nav-item {
            padding: 6px 8px;
            gap: 3px;
          }

          .bottom-nav-icon-wrapper {
            width: 22px;
            height: 22px;
          }

          .bottom-nav-label {
            font-size: 0.65rem;
          }
        }

        /* Mobile */
        @media (max-width: 640px) {
          .bottom-navigation {
            height: 60px;
          }

          .bottom-nav-item {
            padding: 4px 6px;
            gap: 2px;
          }

          .bottom-nav-icon-wrapper {
            width: 20px;
            height: 20px;
          }

          .bottom-nav-label {
            font-size: 0.6rem;
          }
        }
      `}</style>
    </nav>
  );
}
